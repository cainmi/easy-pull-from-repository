data:text/html;charset=utf-8,%0A%0A<!DOCTYPE html>%0A%0A<html>%0A%0A    <head>%0A  <title>%0A%0A    </title>%0A  %0A    <style> %0A        html, body {    height: 100%;    margin: 0;  }  %0A        body {    background: black;    display: flex;    align-items: center;    justify-content: center;  }  %0A        canvas {    border: 1px solid white;  }  </style>%0A    </head>%0A    <body>%0A        <canvas width="400" height="400" id="game">%0A%0A        </canvas>%0A        <script>%0Avar canvas = document.getElementById('game');%0Avar context = canvas.getContext('2d');%0A%0Avar grid = 16;%0Avar count = 0;%0A%0Avar snake = {%0A  x: 160,%0A  y: 160,%0A%0A  // snake velocity. moves one grid length every frame in either the x or y direction%0A  dx: grid,%0A  dy: 0,%0A%0A  // keep track of all grids the snake body occupies%0A  cells: [],%0A%0A  // length of the snake. grows when eating an apple%0A  maxCells: 4%0A};%0Avar apple = {%0A  x: 320,%0A  y: 320%0A};%0A%0A// get random whole numbers in a specific range%0A// @see https://stackoverflow.com/a/1527820/2124254%0Afunction getRandomInt(min, max) {%0A  return Math.floor(Math.random() * (max - min)) + min;%0A}%0A%0A// game loop%0Afunction loop() {%0A  requestAnimationFrame(loop);%0A%0A  // slow game loop to 15 fps instead of 60 (60/15 = 4)%0A  if (++count < 4) {%0A    return;%0A  }%0A%0A  count = 0;%0A  context.clearRect(0,0,canvas.width,canvas.height);%0A%0A  // move snake by it's velocity%0A  snake.x += snake.dx;%0A  snake.y += snake.dy;%0A%0A  // wrap snake position horizontally on edge of screen%0A  if (snake.x < 0) {%0A    snake.x = canvas.width - grid;%0A  }%0A  else if (snake.x >= canvas.width) {%0A    snake.x = 0;%0A  }%0A%0A  // wrap snake position vertically on edge of screen%0A  if (snake.y < 0) {%0A    snake.y = canvas.height - grid;%0A  }%0A  else if (snake.y >= canvas.height) {%0A    snake.y = 0;%0A  }%0A%0A  // keep track of where snake has been. front of the array is always the head%0A  snake.cells.unshift({x: snake.x, y: snake.y});%0A%0A  // remove cells as we move away from them%0A  if (snake.cells.length > snake.maxCells) {%0A    snake.cells.pop();%0A  }%0A%0A  // draw apple%0A  context.fillStyle = 'red';%0A  context.fillRect(apple.x, apple.y, grid-1, grid-1);%0A%0A  // draw snake one cell at a time%0A  context.fillStyle = 'green';%0A  snake.cells.forEach(function(cell, index) {%0A%0A    // drawing 1 px smaller than the grid creates a grid effect in the snake body so you can see how long it is%0A    context.fillRect(cell.x, cell.y, grid-1, grid-1);  %0A%0A    // snake ate apple%0A    if (cell.x === apple.x && cell.y === apple.y) {%0A      snake.maxCells++;%0A%0A      // canvas is 400x400 which is 25x25 grids %0A      apple.x = getRandomInt(0, 25) * grid;%0A      apple.y = getRandomInt(0, 25) * grid;%0A    }%0A%0A    // check collision with all cells after this one (modified bubble sort)%0A    for (var i = index + 1; i < snake.cells.length; i++) {%0A%0A      // snake occupies same space as a body part. reset game%0A      if (cell.x === snake.cells[i].x && cell.y === snake.cells[i].y) {%0A        snake.x = 160;%0A        snake.y = 160;%0A        snake.cells = [];%0A        snake.maxCells = 4;%0A        snake.dx = grid;%0A        snake.dy = 0;%0A%0A        apple.x = getRandomInt(0, 25) * grid;%0A        apple.y = getRandomInt(0, 25) * grid;%0A      }%0A    }%0A  });%0A}%0A%0A// listen to keyboard events to move the snake%0Adocument.addEventListener('keydown', function(e) {%0A  // prevent snake from backtracking on itself by checking that it's %0A  // not already moving on the same axis (pressing left while moving%0A  // left won't do anything, and pressing right while moving left%0A  // shouldn't let you collide with your own body)%0A%0A  // left arrow key%0A  if (e.which === 37 && snake.dx === 0) {%0A    snake.dx = -grid;%0A    snake.dy = 0;%0A  }%0A  // up arrow key%0A  else if (e.which === 38 && snake.dy === 0) {%0A    snake.dy = -grid;%0A    snake.dx = 0;%0A  }%0A  // right arrow key%0A  else if (e.which === 39 && snake.dx === 0) {%0A    snake.dx = grid;%0A    snake.dy = 0;%0A  }%0A  // down arrow key%0A  else if (e.which === 40 && snake.dy === 0) {%0A    snake.dy = grid;%0A    snake.dx = 0;%0A  }%0A});%0A%0A// start the game%0ArequestAnimationFrame(loop);%0A</script>%0A%0A    </body>%0A    </html>
